<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Analisa 2D</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #1a1a1a; color: #eee; padding: 20px; text-align: center; }
        .menu-tombol { margin-bottom: 30px; display: flex; justify-content: center; gap: 10px; }
        button { padding: 12px 25px; cursor: pointer; border: none; border-radius: 5px; background: #333; color: white; font-weight: bold; transition: 0.3s; }
        button:hover { background: #555; }
        button.active { background: #d9534f; box-shadow: 0 0 10px rgba(217, 83, 79, 0.5); }
        
        .main-layout { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; }
        .card { background: #222; padding: 20px; border-radius: 15px; box-shadow: 0 10px 20px rgba(0,0,0,0.5); width: 100%; max-width: 450px; }
        
        h2 { color: #d9534f; margin-top: 0; text-transform: uppercase; font-size: 1.2em; border-bottom: 1px solid #444; padding-bottom: 10px; }
        h2.hijau { color: #5cb85c; }
        
        .grid-2d { 
            display: grid; 
            grid-template-columns: repeat(5, 1fr); 
            gap: 8px; 
            max-height: 500px; 
            overflow-y: auto; 
            padding: 10px;
        }
        .item-2d { 
            background: #333; 
            padding: 8px; 
            border-radius: 4px; 
            font-size: 1.3em; 
            font-weight: bold; 
            border: 1px solid #444;
        }
        .item-belum { color: #5cb85c; border-color: #5cb85c33; }
        
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #444; border-radius: 10px; }
    </style>
</head>
<body>

    <h1>ANALISA 2D (100 TERAKHIR)</h1>

    <div class="menu-tombol">
        <button onclick="pilihPasaran('hk', this)">HONGKONG</button>
        <button onclick="pilihPasaran('sdy', this)">SYDNEY</button>
        <button onclick="pilihPasaran('sgp', this)">SINGAPORE</button>
    </div>

    <div class="main-layout">
        <div class="card">
            <h2 id="judul-sudah">Data Keluar</h2>
            <div id="display-sudah" class="grid-2d"></div>
        </div>

        <div class="card">
            <h2 id="judul-belum" class="hijau">Belum Keluar</h2>
            <div id="display-belum" class="grid-2d"></div>
        </div>
    </div>

    <script>
        const username = "Mahasewa";
        const repo = "mesin-bbfs";

        async function pilihPasaran(pasaran, btn) {
            const tombols = document.querySelectorAll('button');
            tombols.forEach(t => t.classList.remove('active'));
            btn.classList.add('active');

            const displaySudah = document.getElementById('display-sudah');
            const displayBelum = document.getElementById('display-belum');
            
            displaySudah.innerHTML = "Loading...";
            displayBelum.innerHTML = "Loading...";

            const url = `https://raw.githubusercontent.com/${username}/${repo}/main/data_keluaran_${pasaran}.txt`;

            try {
                const response = await fetch(url);
                const data = await response.text();
                const baris = data.trim().split("\n");
                
                // 1. Ambil 100 baris terakhir
                const barisTerakhir = baris.slice(-100).reverse();
                
                // 2. Kumpulkan angka 2D yang SUDAH keluar (untuk filter)
                let sudahKeluarArr = [];
                let htmlSudah = "";
                
                barisTerakhir.forEach(angka => {
                    let clean = angka.trim();
                    if(clean.length >= 2) {
                        const duaD = clean.slice(-2);
                        sudahKeluarArr.push(duaD);
                        htmlSudah += `<div class="item-2d">${duaD}</div>`;
                    }
                });

                // 3. Cari angka yang BELUM keluar (00-99)
                let htmlBelum = "";
                let countBelum = 0;
                for(let i = 0; i <= 99; i++) {
                    // Format angka jadi 2 digit (misal: 5 jadi 05)
                    let formatAngka = i.toString().padStart(2, '0');
                    
                    if(!sudahKeluarArr.includes(formatAngka)) {
                        htmlBelum += `<div class="item-2d item-belum">${formatAngka}</div>`;
                        countBelum++;
                    }
                }

                document.getElementById('judul-sudah').innerText = pasaran.toUpperCase() + " (KELUAR)";
                document.getElementById('judul-belum').innerText = "BELUM KELUAR (" + countBelum + ")";
                displaySudah.innerHTML = htmlSudah;
                displayBelum.innerHTML = htmlBelum;

            } catch (error) {
                displaySudah.innerHTML = "Gagal ambil data.";
                displayBelum.innerHTML = "-";
            }
        }
    </script>
</body>
</html>
